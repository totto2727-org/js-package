---
"@totto2727/result": minor
---

## 標準のエラークラスを活用する方針に転換

### 概要

このライブラリでは、型付きの例外を扱うため`TypedResult`型の使用を推奨していました。
しかし、スタックトレースや各種ライブラリの都合上、標準のErrorクラス、もしくはその拡張クラスを利用する方がシンプルに収まる場合も多いです。
また、`Typed**`はそのままシリアライズ可能であるため、Next.jsのServer Actionsなどで利用しやすい反面、機密情報を含めて送信してしまうリスクがあります。
これらを踏まえ以下のような設計に変更しました。

- 標準の`Error`クラスを利用してください
  - `Result`型の`Failure`側は、`Error`クラスもしくはその拡張クラスのみ許容します
- シリアライズを意図的に行う必要があります
  - `serialize`関数に`Result`型とシリアライズ関数を渡すことで、`Failure`側が任意の`Record`型である`SerializableResult`を取得する事ができます
  - `SerializaleResult`は基本的に本ライブラリのユーティリティ関数を適用できません
  - 再度`Result`に変換するか、`unwrap*`関数などで通常の値に変換してください
  - エラーオブジェクトを直接シリアライズした際の動作は保証しません

### 破壊的変更とその対応

- `Typed**`型とその関連関数の削除
  - `Result`型と`fail`関数に変換してください
- `Result`型の`Failure`は、`Error`型もしくは継承した型のみ受け付けます
  - シリアライズする必要がある場合は、`serialize`関数を実行して`SerializableResult`型に変換してください
- 一部関数の引数が変更されており対応が必要です
  - `tryCatch*`関数は失敗時の関数が削除されました
    - `throw`された値が`Error`クラスもしくは拡張クラスであればそのままを投げ返し、それ以外であれば`Error`オブジェクトへの変換を試みます
    - 既存の処理は`mapError`関数などを用いて対応してください
